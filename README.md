# Data Advisor

**[EMNLP 2024] Data Advisor: Dynamic Data Curation for Safety Alignment of Large Language Models**

[**ğŸŒ Homepage**](https://feiwang96.github.io/DataAdvisor/) | [**ğŸ“– Paper**](https://arxiv.org/pdf/2410.05269)  | [**ğŸ¤— Dataset (Data Advisor)**](https://huggingface.co/datasets/fwnlp/data-advisor-safety-alignment) | [**ğŸ¤— Dataset (Self-Instruct)**](https://huggingface.co/datasets/fwnlp/self-instruct-safety-alignment)


## Data Generation
Generate safety alignment data with Data Advisor:
```bash
python data_advisor.py
python response_generation.py
```

Generate safety alignment data with Self-Instruct:
```bash
python self_instruct.py
python response_generation.py
```


## Training
First prepare Alpagasus data:
```bash
python utils/export_alpagasus.py
```

Then train the target model with safety alignment data generated by data advisor and Alpagasus data:
```bash
python train_target_model.py
```

## Evaluation
Evaluate model safety with LlamaGuard on CatQA and BeaverTails:
```bash
bash scripts/eval_catqa.sh
bash scripts/eval_beavertails.sh
```

Evaluate model utility on MMLU: 
```bash
bash scripts/eval_mmlu.sh
```

## Citation
```
@inproceedings{wang2024data,
  title={Data Advisor: Dynamic Data Curation for Safety Alignment of Large Language Models},
  author={Wang, Fei and Mehrabi, Ninareh and Goyal, Palash and Gupta, Rahul and Chang, Kai-Wei and Galstyan, Aram},
  booktitle={Proceedings of EMNLP 2024},
  year={2024}
}
```
